CREATE VIEW top_footballers_on_instagram_for_each_country AS

SELECT COUNTRY AS 'Country', 
	CAST(SUBSTRING(NAME, 1, CHARINDEX('@', NAME) -1) AS VARCHAR(100)) AS 'Footballers',
	CAST(SUBSTRING(FOLLOWERS, 1, CHARINDEX('M', FOLLOWERS) -1) AS FLOAT) AS 'Followers_in_millions'	
FROM all_countries_insta_data WHERE TOPIC_OF_INFLUENCE LIKE '%soccer%'
AND COUNTRY IS NOT NULL
AND CAST(SUBSTRING(NAME, 1, CHARINDEX('@', NAME) -1) AS VARCHAR(100)) NOT LIKE '%FC'
AND CAST(SUBSTRING(NAME, 1, CHARINDEX('@', NAME) -1) AS VARCHAR(100)) NOT LIKE 'FC%'
AND CAST(SUBSTRING(NAME, 1, CHARINDEX('@', NAME) -1) AS VARCHAR(100)) NOT LIKE '%F.C'
AND CAST(SUBSTRING(NAME, 1, CHARINDEX('@', NAME) -1) AS VARCHAR(100)) NOT LIKE 'F.C%'
AND TOPIC_OF_INFLUENCE NOT LIKE '%Team%';


